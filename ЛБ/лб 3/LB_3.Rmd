---
title: "Lab3-ZVIT"
author: "Mykhailyk Maksym"
date: "2025-12-7"
output:
  github_document:
    toc: yes
---
**Лабораторна робота № 3**

**Тема. Основи вибіркового методу**

**Мета : засвоїти основи статистичного оцінювання характеристик випадкової величини на основі вибіркового підходу засобами мови програмування R; набути навичок роботи у середовищі RStudio із застосуванням концепції “грамотного програмування” із застосуванням пакету R Markdown.**

**1 . Постановка задачі.**

Випадкова величина X має нормальний закон розподілу: X∼F(a,σ2), тобто X∼N(a,σ2), вектор параметрів Θ=(a,σ2) якого відомий: (a,σ2)=( 0 , 3 ) . Тобто, a= 0, σ2= 3. Згенерувати дві вибірки випадкової величини X за допомогою відповідного генератору псевдовипадкових чисел: (x1,x2,...,xn) відповідно обсягів n=100 та n=1000, що мають розподіл X∼N( 0, 9 ), обчислити і дослідити оцінки параметрів розподілу a~=a~(x1,x2,...,xn)≈a, σ~=σ~(x1,x2,...,xn)=σ та інші статистичні характеристики, зробити порівняльний аналіз оцінених характеристик між собою і з теоретичними характеристиками.

**2 . Генеруємо вибірку з нормального розподілу з параметрами a= 0, σ= 3 об’єму n= 100 та будуємо варіаційни ряд для неї**

```{r}
set.seed(0) 
n <- 100  
a <- 0  
s <- 3 
X <- rnorm(n, a, s)
cat("\n", "Параметри вибірки:", "\n", "a = ", a, "\n" , "s = ", s, "\n" , "n = ", n, "\n")
```


```{r}
cat("Перші елементи вибірки:", head(X))
```


```{r}
cat("Останні елементи вибірки:", tail(X))
```


```{r}
SortX <- sort(X)
plot(SortX, col=4)
title("Варіаційний ряд - доля значень")
```

**3 . Будуємо інтервальний статистичний розподіл і гістограму частот.**


```{r}
1 + 1.332 * log(n)
```


```{r}
table(cut(X, nclass.Sturges(X)))
```


```{r}
hist(X, breaks=nclass.Sturges(X),
     col="Lightblue",
     main="Гістограма частот")
```


```{r}
hist(X,
     freq = FALSE,
     col = "Lightblue",
     main = "Гістограма відносних частот")
curve(dnorm(x, a, s), col = 2, lty = 2, lwd = 2, add = TRUE) 
curve(dnorm(x, mean(X), sd(X)), col = 3, lty = 2, lwd = 2, add = TRUE)
```

**4 . Виводимо сумарні статистики**

```{r}
summary(X)
```

Альтернативний варіант за допомогою спеціальних функцій

```{r}
mean(X)
sd(X)
IQR(X)
```

:Таблиця 2 -- __Числові характеристики вибірки__

Характеристика | Значення
-----|-----
$\tilde{m}(x)$| `r mean(X)`
$\tilde{\tilde{\sigma}}(x)$| `r sd(X)`
$\tilde{R}$| `r IQR(X)`


```{r}
library(Hmisc)
describe(X)
```

Варіант з власною функцією

```{r}
library(moments)
my_summary <- function(X, ...) {
  cat("\n", "Оцінки статистичних характеристик вибірки:", "\n", 
      "вибіркове математичне сподівання, m = ", mean(X), "\n",
      "Медіана, Ме = ", median(X) , "\n",
      "вибіркова дисперсія, s^2 = ", var(X), "\n" ,
      "вибіркове СКВ, s = ", sd(X), "\n" ,
      "Розмах, R = ", max(X) - min(X), "\n" ,
      "Інтерквартільний розмах, IQR = ", IQR(X), "\n",
      "Ексцес, Ek = ", kurtosis(X), "\n",
      "Асиметрія, As= ", skewness(X), "\n"
    )
}

my_summary(X,  na.rm=FALSE)
```


**5 . Створюємо представлення теоретичного і емпіричного розподілів.**

```{r}
plot(density(X, adjust=2), main="X", col=4)
rug(X, col=2) 
```

```{r}


Fn <- ecdf(X)


plot(Fn,
     verticals = TRUE,
     col.points = "blue",
     col.hor = "red",
     col.vert = "bisque",
     main = "Емпірична функція розподілу")
```

**6 . Побудуємо боксплоти**

```{r}
library(beeswarm)
boxplot(X, main="box-plot X")  
beeswarm(X, col=2, add=TRUE) 
```


**7 . Виконаємо компактний варіант виводу основних графіків вибіркових характеристик**


```{r}
library(beeswarm)
library(moments)
# --- КОНЕЦ ИСПРАВЛЕНИЯ ---

# Восстанавливаем данные (на случай, если R "забыл" их из прошлых шагов)
if (!exists("X")) {
  set.seed(0)
  n <- 100
  a <- 0
  s <- 3
  X <- rnorm(n, a, s)
  Fn <- ecdf(X)
}

# Строим графики
op <- par(mfrow = c(2,2))

# 1. Гистограмма
hist(X, freq = FALSE, col = "Lightgray", main="Histogram", border=4)
curve(dnorm(x, a, s), col = 2, lty = 2, lwd = 2, add = TRUE)

# 2. Квантили
plot(Fn, main = "Quantile Plot", verticals = TRUE, col.points = "blue", col.hor = "red", col.vert = "bisque", xlab = "X", ylab = "Fn(x)")

# 3. Боксплот + Beeswarm (тут была ошибка)
boxplot(X, main = "Box-and-Wisker Plot", col = "Lightgray", border = 4, xlab = "X", ylab = "", horizontal = TRUE)
beeswarm(X, col = 2, add = TRUE, horizontal = TRUE)

# 4. Плотность
plot(density(X, adjust=2), main = "density trace", xlab = "X", ylab = "Dencity", col="blue")
rug(X, col=2)

par(op)
```

**8 . Створюємо результуючу таблицю**

:Таблиця 3 -- __Теоретичні та емпіричні (вибіркові) числові характеристики випадкової величини__


Назва числової характеристики | теоретичне значення | Вибіркове значення, $n=$ `r n` | Вибіркове значення, $n=1000$ |
--------|----|------|---------
$a$|`r a`| `r mean(X)` | $\tilde a$
$\sigma$|`r s`|`r sd(X)`|${\tilde{\sigma}}$
Математичне сподівання|`r a`|`r mean(X)`|$\tilde{m}(x)$
Дисперсія|`r s^2`|`r var(X)`|$\tilde{D}(x)$
Виправлена дисперсія||`r var(X)*n/(n-1)`|$\tilde{\tilde{D}}(x)$
СКВ|`r s`|`r sd(X)`|$\tilde{\sigma}(x)$
Виправлене СКВ||`r sqrt(var(X)*n/(n-1))`|$\tilde{\tilde\sigma}(x)$
Центральний момент $3$-го порядку|$\mu_3$|$\tilde{\mu}_3$|$\tilde{\mu}_3$
Центральний момент $4$-го порядку|$\mu_4$|$\tilde{\mu}_4$|$\tilde{\mu}_4$
Асимерія|$A_s$|$\tilde{A}_s$|$\tilde{A}_s$
Ексцес|$E_k$|$\tilde{E}_k$|$\tilde{E}_k$

<center>**9 . Контрольні питання**<center>

1. Що таке вибірка? - це частина об'єктів генеральної сукупності, відібраних для спостереження, щоб отримати інформацію про властивості всієї сукупності.

2. Як можна оцінити вибіркове математичне сподівання? - Вибіркове математичне сподівання оцінюється через вибіркове середнє , яке в R обчислюється функцією mean(X). Це точка, навколо якої групуються значення вибірки.

3. Які існують міри розсіювання? - Основні міри розсіювання — це дисперсія (s2) та середнє квадратичне відхилення (s), які показують міру коливання даних навколо середнього. Також існують розмах (R) та інтерквартильний розмах (IQR).

4. Які міри форми розподілу вам відомі? Що вони характеризують? Як їх оцінити на практиці? - Асиметрія та ексцес . Асиметрія характеризує симетричність розподілу відносно центру. Вона показує, в який бік перекошений графік.Ексцес характеризує гостроверхість піку розподілу та важкість хвостів порівняно з нормальним розподілом.На практиці ми оцінюємо їх за допомогою функцій skewness() та kurtosis() або візуально за гістограмою.

**10 . Висновок**

На данному лабараторному занятті засвоїли основи статистичного оцінювання характеристик випадкової величини на основі вибіркового підходу засобами мови програмування R; набули навичок роботи у середовищі RStudio із застосуванням концепції “грамотного програмування” із застосуванням пакету R Markdown.


